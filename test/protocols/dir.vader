"
" Test dir()
"
Execute(dir() should only accept Dict);
let input = [
      \ 1,
      \ 'str',
      \ [],
      \ ]

for x in input
  AssertThrows call object#dir(g:x)
  Assert g:vader_exception =~# 'WrongType'
endfor

Execute(dir() return keys() for ordinary Dict but hooks into __dir__());
let x = {
      \ 'root': '/path/to/somewhere/',
      \ 'has_permisson': 'true',
      \ 'last_access': '/path/to/somefile',
      \ 'refcnt': 10,
      \ }

AssertEqual keys(x), object#dir(x), 'if the Dict has no __dir__(), use key()'

let cls = {
      \ 'x': x
      \ }
function! cls.__dir__()
  return object#dir(self.x)
endfunction

AssertEqual keys(x), object#dir(cls)
